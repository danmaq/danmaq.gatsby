webpackJsonp([78547886008404],{4343:function(a,n){a.exports={data:{markdownRemark:{html:'<p>Windows10 の Anniversary Update で Ubuntu が Windows10 で動くようになりました。</p>\n<p>仮想化とか抜きで Linux？\nな……何を言っているか わからねーと思うｇ\n（よく考えたらついこの前まで Interix 動いてたので、言うほど驚くことではないね）</p>\n<p>これは早速 LAMP 開発環境に仕立て上げねば、ということで、やってみました。</p>\n<h2>■下準備</h2>\n<p>初期設定は<a href="http://qiita.com/Aruneko/items/c79810b0b015bebf30bb">だいたいこの辺のパクリ</a><br>\nbash のインストールが終わるところまでは、↑と完全に一致なので省略。</p>\n<p><strong>[■sudo の警告対策</strong>](<a href="http://qiita.com/ogomr/items/89e19829eb8cc08fcebb">http://qiita.com/ogomr/items/89e19829eb8cc08fcebb</a>)</p>\n<h3>〇 ホスト名を localhost に紐づけ</h3>\n<pre><code class="language-sh">$ sudo sh -c \'echo 127.0.1.1 $(hostname) >> /etc/hosts\'\n</code></pre>\n<h2>■とりまシステムを最新にする</h2>\n<h3>〇 apt-get のリポジトリを国内サーバへ切り替えてアプデ高速化</h3>\n<pre><code class="language-sh">$ sudo sed -i -e \'s%http://.*.ubuntu.com%http://ftp.jaist.ac.jp/pub/Linux%g\' /etc/apt/sources.list\n</code></pre>\n<h3>〇 とりまシステムを最新にする</h3>\n<pre><code class="language-sh">$ sudo apt update\n$ sudo apt -y full-upgrade\n$ sudo apt-get -y autoremove\n</code></pre>\n<p>Ubuntu16にアップグレードするにはこれだけではできません。\n<a href="http://qiita.com/Aruneko/items/2670f42d36a7508c13bb">追加の手続きが要ります</a></p>\n<p>ただし procps が一式機能しなくなったりとか、現状ロクなことにならないので人柱上等な方だけどうぞ。</p>\n<h2>■必要最低限のツール類をインストール</h2>\n<h3>〇 汽車走らせないと気が済まない方へ</h3>\n<pre><code class="language-sh">$ sudo apt-get -y install sl\n$ sl\n</code></pre>\n<h3>〇 vim(Full版)は常用するので入れとけ、それと git も使うのでまあ入れとこう</h3>\n<pre><code class="language-sh">$ sudo apt-get -y install vim-nox git\n</code></pre>\n<p>〇 landscape はいらないので捨てる</p>\n<pre><code class="language-sh">$ sudo apt-get -y purge landscape-client landscape-common\n</code></pre>\n<h2>■sudo でパスワードいちいち聞かれるのうざいので止める</h2>\n<h3>〇 wheel グループを作り、自分自身を所属させる</h3>\n<pre><code class="language-sh">$ sudo addgroup wheel\n$ sudo usermod -aG wheel ユーザー名\n</code></pre>\n<h3>〇 wheel グループに属する人だけ root になれる</h3>\n<pre><code class="language-sh">$ sudo vim /etc/pam.d/su\n</code></pre>\n<pre><code># Uncomment this if you want wheel members to be able to\n# su without a password.\n# auth       sufficient pam_wheel.so trust\nauth       sufficient pam_wheel.so trust group=wheel\n</code></pre>\n<p>↑ この最後の 1 行を挿入</p>\n<h3>〇 wheel グループに所属するユーザは sudo で顔パスできるようにする</h3>\n<pre><code class="language-sh">$ sudo visudo\n</code></pre>\n<pre><code># Same thing without a password\n%wheel ALL=(ALL) NOPASSWD:ALL\n</code></pre>\n<p>↑ 末尾に挿入</p>\n<p>// visudo なのに、nano が起動してしまう、七不思議の一つなの……</p>\n<h2>■スタートアップ・シャットダウンのスクリプトを入れる</h2>\n<p>Ubuntu on Windows では rcX.d のスクリプトは自動で動いてくれません。\nLAMP 環境構築するにあたり、これでは辛いので自動で動かす処理を仕込みます。\nちょっと長いのでKIAIで。</p>\n<h3>〇 起動スクリプトを書く</h3>\n<p><a href="https://gist.github.com/danmaq/8825128e199c787b46ca61e4786447a8">Ubuntu on Windows 用 /etc/rcX.d/ 配下のスクリプトをまとめて叩くスクリプト - GitHub Gist</a><br>\n↑即興でスクリプト書いたので、このファイルをカレントフォルダに作ってください。</p>\n<h3>〇 作ったファイルを移動する</h3>\n<pre><code class="language-sh">$ chmod 700 rund4wsl.sh\n$ sudo chown root:root rund4wsl.sh\n$ sudo mv rund4wsl.sh /usr/local/sbin/rund4wsl\n</code></pre>\n<h3>〇 試してみよう</h3>\n<pre><code class="language-sh">$ sudo rund4wsl -l 0 -o stop\n</code></pre>\n<p>bash がシャットダウンされたら成功。</p>\n<p>ちなみに -l オプションはランレベル、-o オプションは各スクリプトへ丸投げするコマンドです。<br>\nスタートアップ時は -l 3 -o start、シャットダウン時は -l 0 -o stop と指定します。</p>\n<p>(ここからは Windows 側での作業)</p>\n<h3>〇 スクリプトを Windows 側から呼び出すスクリプトを書く</h3>\n<p><a href="https://gist.github.com/danmaq/8825128e199c787b46ca61e4786447a8">Ubuntu on Windows 用 /etc/rcX.d/ 配下のスクリプトをまとめて叩くスクリプト :: GitHub Gist</a><br>\n↑のコメントを参照してバッチファイルを作ってください。\n置き場は好みですが、<code>C:/Users/[ユーザー名]/</code> 直下に bin フォルダ作って、そこに放り込むのが行儀良さげかも。</p>\n<h3>〇 呼び出しスクリプトを登録する</h3>\n<p><a href="https://orebibou.com/2015/03/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%94%E3%81%A8%E3%81%AE%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%97%E3%83%9D%E3%83%AA%E3%82%B7%E3%83%BC%E3%82%BB%E3%82%AD%E3%83%A5/">ユーザーごとのローカルグループポリシー(セキュリティポリシー)を設定する :: 俺的備忘録 〜なんかいろいろ〜 </a><br>\n↑を参考に、自分のユーザー名でグループ ポリシー オブジェクト エディターを開きます。</p>\n<p><code>/コンソール ルート/ローカル コンピューター\\\\[ユーザー名] ポリシー/ユーザーの構成/Windows の設定/スクリプト(ログオン/ログオフ)</code> のフォルダを開きます。<br>\nログオン スクリプトとログオフ スクリプトにそれぞれ登録してあげます。</p>\n<h3>〇 動作確認</h3>\n<p>Windows を再ログオンしてから、bash を起動します。<br>\n(再びここから bash 側での作業)</p>\n<pre><code class="language-sh">$ ps x | grep rund4wsl\n</code></pre>\n<p>↑で grep 以外にも該当するやつがいたら成功です。</p>\n<h2>■LAMP 構築する</h2>\n<p>Apache・MariaDB(MySQL)・PHPを入れます。\nUbuntu 14 の標準でインストールできる php が 5.5.9 と型落ちモデルなので 7.1 にしてしまいましょう。\n<a href="http://qiita.com/walrein/items/b0cc229619ac78852898">工程の大半がほとんどこの辺のパクリです。</a></p>\n<pre><code class="language-sh">$ sudo add-apt-repository ppa:ondrej/php\n$ sudo apt-get update\n$ sudo apt-get -y install mariadb-server libapache2-mod-php7.1\n</code></pre>\n<p>インストール途中で mariadb の root ユーザーパスワード聞かれるので、好きなように設定する</p>\n<h3>〇 リポジトリ追加したのでついでにやる</h3>\n<pre><code class="language-sh">    sudo apt -y full-upgrade\n    sudo apt-get -y autoremove\n</code></pre>\n<p>ここで bash を抜けて Windows を再ログオンして、 MariaDB と Apache を起動します。<br>\nEdge で <a href="http://localhost/">http://localhost/</a> を確認します。</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/danmaq.gatsby/static/2016-wsl-lamp-6f2d9c46693382a6bc5e70c65c3e843f-51071.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 45.32374100719424%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACKElEQVQoz02RSU9TYRSG748pZVjIli3StUopYzG4cC3/wUSNiQsTEySujAsDhkmJSJliwVLAigxtaUt7p95Ot70tQ6Kw8fH0ysLFk/e87znfyZfvU253d+Pr6aFH8Pl8dHV10d7eTmurF4/HQ4vg+Y+WFo/0WvF6vS5tbW10dHS4dHbeQvH7+7hz9x69ooGBQfx9AYLBUUZH79PsNX0g0E+faNMPDA4xNvaAoPSHR4L0y5kRmR8aHqG314+SyqjUKzba44cUw1+oXfwmthcj/HWT6PYOsdi+1FtEo7vs7uyxsREmEokS+bbtaqlYcanVGuJ3UCynQf3XJdr7F5RSP7gGSud1dLtMoeFQuTxHr5TJ16qSN9CrNoWzOqWLMwypm/NXwh9h/ziOkny3yNajJ4TGn7E+/pTT52+xJ+cpv56lPDFD+c08ztQqzvSqZHNUJgXR8sSszM1hvZp2Kb6c4vuHzyjx0Ca5j2tkFzdc0gurwgoZydILa2Q+rZNbi5BeDnMyFyI1v0JiZkk0RHJ22fXqUpizyCFHm7soR6kUCfWUpJbj5IaMaaCVCm59nM2QEJJqVnIdrVzEqJQw7OYzVLAcG10y+/KCVDaHkk6fYuXzFART19FVDcs0MQ2D/A22fFqtWsWp1lxt1OtSVzlvNKjaVUHe8uqa5i7l58ER8UScePwfumGSN/OostiQxZZloWm6W5uS51RVvOaiywVU8c1Zx6lzcHjMX9OeL6daT1mnAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="2016 wsl lamp"\n        title=""\n        src="/danmaq.gatsby/static/2016-wsl-lamp-6f2d9c46693382a6bc5e70c65c3e843f-ad916.png"\n        srcset="/danmaq.gatsby/static/2016-wsl-lamp-6f2d9c46693382a6bc5e70c65c3e843f-01de1.png 148w,\n/danmaq.gatsby/static/2016-wsl-lamp-6f2d9c46693382a6bc5e70c65c3e843f-695fb.png 295w,\n/danmaq.gatsby/static/2016-wsl-lamp-6f2d9c46693382a6bc5e70c65c3e843f-ad916.png 590w,\n/danmaq.gatsby/static/2016-wsl-lamp-6f2d9c46693382a6bc5e70c65c3e843f-51071.png 834w"\n        sizes="(max-width: 590px) 100vw, 590px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    <br>\nやったー！Ubuntu を捕まえた！</p>\n<h3>〇 データベースの初期設定をする</h3>\n<pre><code>$ sudo mysql_secure_installation\n</code></pre>\n<p>mariadb の root ユーザーパスワード聞かれるので、さっき決めたやつを入れる<br>\n最初の質問だけ n であとは Enter 連打でおｋ これで出来上がり！</p>\n<p>PHP もちゃんと入ってるか確認しようね</p>\n<pre><code class="language-sh">$ php -v\n</code></pre>\n<h2>■質疑応答</h2>\n<p><a href="https://twitter.com/danmaq">ほかにも何かあったら質問ください</a>。</p>',frontmatter:{cover:{childImageSharp:{responsiveSizes:{src:"/danmaq.gatsby/static/2016-wsl-lamp-6f2d9c46693382a6bc5e70c65c3e843f-2fd78.png",srcSet:"/danmaq.gatsby/static/2016-wsl-lamp-6f2d9c46693382a6bc5e70c65c3e843f-739b5.png 200w,\n/danmaq.gatsby/static/2016-wsl-lamp-6f2d9c46693382a6bc5e70c65c3e843f-549e8.png 400w,\n/danmaq.gatsby/static/2016-wsl-lamp-6f2d9c46693382a6bc5e70c65c3e843f-2fd78.png 800w,\n/danmaq.gatsby/static/2016-wsl-lamp-6f2d9c46693382a6bc5e70c65c3e843f-91971.png 834w",sizes:"(max-width: 800px) 100vw, 800px"}}},date:"2016-08-13T14:37:38+09:00",strDate:"2016/8/13",title:"Ubuntu on Windows で LAMP 環境を構築するお話"}}},pathContext:{path:"/ja/blog/2016/08/13-lamp-on-wsl/",langKey:"ja"}}}});
//# sourceMappingURL=path---ja-blog-2016-08-13-lamp-on-wsl-40f600ed173682efbb01.js.map